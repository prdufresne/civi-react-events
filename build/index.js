(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.React;var a=e.n(n);function l(e){const{startDate:n,endDate:a}=e;let l=n.weekday,r=n.day,i="";return a&&n.date!=a.date&&(l=`${n.weekday.substring(0,3)}-${a.weekday.substring(0,3)}`,r+=`-${parseInt(a.day)}`,i=" multiday"),(0,t.createElement)("div",{class:"civi-react-events-cell-date"},(0,t.createElement)("div",{class:"civi-react-events-weekday"},l),(0,t.createElement)("div",{class:"civi-react-events-day"+i},r))}class r extends a().Component{constructor(e){super(e),this.state={title:"Civi React Calendar",events:[],event_types:[],showFilter:!1,filters:{}},this.changeHandler=this.changeHandler.bind(this)}componentDidMount(){this.loadData()}loadData(){this.fetchEvents().then((e=>{const{events:t,event_types:n}=e,a={applied:{event_type:!1,registration:!1,event_full:!1},event_type:{},registration:{registered:!1,not_registered:!1},event_full:{available:!1,full:!1}};n.forEach((e=>{a.event_type[e.value]=!1})),this.setState({events:t,event_types:n,filters:a})}))}fetchEvents=()=>new Promise(((e,t)=>{jQuery.post(my_ajax_object.ajax_url,{action:"civi_react_events",request:"event-list",data:"This is data passed to the backed"},(function(t){return e(JSON.parse(t))})).fail((function(e){return t(e)}))}));changeHandler(e){const{name:t,id:n,checked:a}=e.target,{filters:l}=this.state;l[t][n.toString()]=a,l.applied[t]=this.anyChecked(l[t]),this.setState({filters:l})}anyChecked(e){let t=!1;return e&&Object.keys(e).forEach((n=>{t=t||e[n]})),t}render(){const{event_types:e,events:n,showFilter:a,filters:r}=this.state;let i="";return(0,t.createElement)("div",null,(0,t.createElement)("div",{className:"civi-react-events-filter-block"},(0,t.createElement)("div",{className:"civi-react-events-button",onClick:()=>this.setState({showFilter:!a})},a?"Hide Filters":"Show Filters"),(0,t.createElement)("div",{className:"civi-react-events-filters "+(a?"":"hide")},(0,t.createElement)("div",{className:"civi-react-events-filters-types"},e.map(((e,n)=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)("input",{type:"checkbox",name:"event_type",id:e.value,onChange:this.changeHandler,checked:this.filters?.event_type[e.value]}),(0,t.createElement)("label",null,e.label),(0,t.createElement)("br",null))))),(0,t.createElement)("div",{className:"civi-react-events-filters-status"},(0,t.createElement)("input",{type:"checkbox",name:"registration",id:"registered",onChange:this.changeHandler}),(0,t.createElement)("label",null,"Registered"),(0,t.createElement)("br",null),(0,t.createElement)("input",{type:"checkbox",name:"registration",id:"not_registered",onChange:this.changeHandler}),(0,t.createElement)("label",null,"Not Registered"),(0,t.createElement)("br",null),(0,t.createElement)("input",{type:"checkbox",name:"event_full",id:"available",onChange:this.changeHandler}),(0,t.createElement)("label",null,"Available Events"),(0,t.createElement)("br",null),(0,t.createElement)("input",{type:"checkbox",name:"event_full",id:"full",onChange:this.changeHandler}),(0,t.createElement)("label",null,"Full Events"),(0,t.createElement)("br",null)))),n.map(((e,n)=>{if((!r.applied.event_type||r.event_type[e.event_type_id.toString()])&&(!r.applied.registration||r.registration[e.is_registered?"registered":"not_registered"])&&(!r.applied.event_full||r.event_full[e.is_full?"full":"available"])){const{start_date:a,end_date:r}=e;let s=!1;return a.month!=i&&(i=a.month,s=!0),(0,t.createElement)(t.Fragment,null,s&&(0,t.createElement)("h3",null,i),(0,t.createElement)("div",{index:n,type:e["event_type_id:label"],className:"civi-react-events-event"},(0,t.createElement)("a",{href:e.event_url},(0,t.createElement)(l,{startDate:a,endDate:r}),(0,t.createElement)("div",{className:"civi-react-events-content-column"},e.is_online_registration&&!e.is_full&&!e.is_registered&&(0,t.createElement)("a",{href:e.registration_url},(0,t.createElement)("div",{className:"civi-react-events-button"},"Register")),(0,t.createElement)("div",{className:"civi-react-events-title"},e.title,e.is_full&&(0,t.createElement)("div",{className:"civi-react-events-pill full"},"Full"),e.is_registered&&(0,t.createElement)("div",{className:"civi-react-events-pill registered"},"Registered")),(0,t.createElement)("div",{className:"civi-react-events-description"},e.summary)))))}})))}}const i=r,s=document.getElementById("civi-react-events");s&&(0,t.render)((0,t.createElement)(i,null),s)})();